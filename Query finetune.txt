Mispromise Query for GM:

SELECT 
    CASE
        WHEN YOL.SHIPNODE_KEY = '5885' THEN 'Stokes'
        WHEN YOL.SHIPNODE_KEY = '2820' THEN 'Bradford'
        WHEN YOL.SHIPNODE_KEY = '8604' THEN 'Brands'
        WHEN YOL.SHIPNODE_KEY = '5607' THEN 'Sherburn'
        WHEN YOL.SHIPNODE_KEY = '8222' THEN 'Ollerton'
        WHEN YOL.SHIPNODE_KEY LIKE 'M0%' THEN 'Dropship'
        WHEN YOL.SHIPNODE_KEY = '4624' THEN 'Donnington'
        ELSE 'ISF'
    END AS SHIPNODE,
    COUNT(DISTINCT YOL.EXTN_FP_RELEASE_ID) AS Order_Count
FROM STRADMIN1.SPKV_YFS_ORDER_HEADER YOH
JOIN STRADMIN1.SPKV_YFS_ORDER_LINE YOL
  ON YOH.ORDER_HEADER_KEY = YOL.ORDER_HEADER_KEY
JOIN STRADMIN1.YFS_ORDER_RELEASE_STATUS ODS
  ON YOH.ORDER_HEADER_KEY = ODS.ORDER_HEADER_KEY
AND YOL.ORDER_LINE_KEY = ODS.ORDER_LINE_KEY
JOIN STRADMIN1.YFS_STATUS YS
  ON ODS.STATUS = YS.STATUS
JOIN STRADMIN1.YFS_TASK_Q Q
  ON Q.DATA_KEY = ODS.ORDER_RELEASE_KEY
AND Q.TRANSACTION_KEY = 'POST_OF_DELAYED_SHIPMENT'
AND Q.AVAILABLE_DATE >= TRUNC(SYSDATE)
AND Q.AVAILABLE_DATE < TRUNC(SYSDATE + 1)
WHERE ODS.STATUS_QUANTITY > 0
  AND YS.PROCESS_TYPE_KEY = 'ORDER_FULFILLMENT'
  AND YOH.SELLER_ORGANIZATION_CODE = 'MSUK_WCS'
  AND YOH.DOCUMENT_TYPE = '0001'
  AND YOL.ORDERED_QTY > 0
  AND YOL.PRODUCT_LINE = 'GM'
GROUP BY 
    CASE
        WHEN YOL.SHIPNODE_KEY = '5885' THEN 'Stokes'
        WHEN YOL.SHIPNODE_KEY = '2820' THEN 'Bradford'
        WHEN YOL.SHIPNODE_KEY = '8604' THEN 'Brands'
        WHEN YOL.SHIPNODE_KEY = '5607' THEN 'Sherburn'
        WHEN YOL.SHIPNODE_KEY = '8222' THEN 'Ollerton'
        WHEN YOL.SHIPNODE_KEY LIKE 'M0%' THEN 'Dropship'
        WHEN YOL.SHIPNODE_KEY = '4624' THEN 'Donnington'
        ELSE 'ISF'
    END
ORDER BY Order_Count DESC


Mispromise Query for NON-GM

SELECT 
    CASE
        WHEN YOL.SHIPNODE_KEY = 'Colours' THEN 'MMFlowers'
        WHEN YOL.SHIPNODE_KEY = 'Hamper' THEN 'Hamper'
        WHEN YOL.SHIPNODE_KEY = 'HHP' THEN 'HHP'
        WHEN YOL.SHIPNODE_KEY = 'FlowerPlus' THEN 'FlowerPlus'
        WHEN YOL.SHIPNODE_KEY = '3007' THEN '4Anjels'
        ELSE  YOL.SHIPNODE_KEY
    END AS SHIPNODE,
    COUNT(DISTINCT YOL.EXTN_FP_RELEASE_ID) AS Order_Count
FROM STRADMIN1.SPKV_YFS_ORDER_HEADER YOH
JOIN STRADMIN1.SPKV_YFS_ORDER_LINE YOL
  ON YOH.ORDER_HEADER_KEY = YOL.ORDER_HEADER_KEY
JOIN STRADMIN1.YFS_ORDER_RELEASE_STATUS ODS
  ON YOH.ORDER_HEADER_KEY = ODS.ORDER_HEADER_KEY
AND YOL.ORDER_LINE_KEY = ODS.ORDER_LINE_KEY
JOIN STRADMIN1.YFS_STATUS YS
  ON ODS.STATUS = YS.STATUS
WHERE ODS.STATUS_QUANTITY > 0
  AND YS.PROCESS_TYPE_KEY = 'ORDER_FULFILLMENT'
  AND YOH.SELLER_ORGANIZATION_CODE = 'MSUK_WCS'
  AND YOH.DOCUMENT_TYPE = '0001'
  AND YOL.ORDERED_QTY > 0 
  AND YOL.SHIPNODE_KEY in ('Colours','Hamper','HHP','FlowerPlus','3007')
  AND ODS.STATUS = '3200.300'
  AND YOH.ORDER_HEADER_KEY >= TO_CHAR(TRUNC(SYSDATE) - 90, 'YYYYMMDD')
  AND YOH.ORDER_HEADER_KEY <  TO_CHAR(TRUNC(SYSDATE), 'YYYYMMDD')
  AND YOL.REQ_DELIVERY_DATE >= TRUNC(SYSDATE)
  AND YOL.REQ_DELIVERY_DATE <  TRUNC(SYSDATE) + 1
GROUP BY 
    CASE
        WHEN YOL.SHIPNODE_KEY = 'Colours' THEN 'MMFlowers'
        WHEN YOL.SHIPNODE_KEY = 'Hamper' THEN 'Hamper'
        WHEN YOL.SHIPNODE_KEY = 'HHP' THEN 'HHP'
        WHEN YOL.SHIPNODE_KEY = 'FlowerPlus' THEN 'FlowerPlus'
        WHEN YOL.SHIPNODE_KEY = '3007' THEN '4Anjels'
        ELSE  YOL.SHIPNODE_KEY
    END
ORDER BY Order_Count DESC


Cancellation Query

SELECT distinct to_char(ors.status_date,'yyyy-mm-dd') as DATES,Count(DISTINCT OL.ORDER_LINE_KEY ) as NOOFLINES,(CASE
    WHEN ORS.MODIFYPROGID in ('Console','SterlingHttpTester','MS_INT_SERVER_113') THEN
    'OPS BAU'
    WHEN ORS.MODIFYPROGID='ORDER_MONITOR_EX' THEN
    'STORE PAYMENT NOT RECEIVED'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_101' THEN
    'STOCK NOT AVAILABLE'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_102' THEN
    'FRAUD NEGATIVE RESPONSE'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_109' AND OL.SHIPNODE_KEY in (SELECT DISTINCT ORGANIZATION_CODE FROM STRADMIN1.YFS_ORGANIZATION WHERE EXTN_PARTICIPATING_BOSS_STORE ='Y'AND ORGANIZATION_CODE NOT IN ('3052','3007')) THEN
    'STORE ORDER PICK EXPIRY'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_109' AND OL.SHIPNODE_KEY not in (SELECT DISTINCT ORGANIZATION_CODE FROM STRADMIN1.YFS_ORGANIZATION WHERE EXTN_PARTICIPATING_BOSS_STORE ='Y'AND ORGANIZATION_CODE NOT IN ('3052','3007')) THEN
    'DC DRL NOT TRIGERED'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key = '5885'THEN
    'Stoke_DC NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key = '8604'THEN
    'Brands DC NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key = '8222'THEN
    'Ollerton-DC  NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120','MS_INT_SERVER_16') and ol.shipnode_key = '4624' THEN
    'CD NILL PICK ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key not in ('5885','8604','8222','4624')THEN
    'STORE NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key = '5885'THEN
    'Stoke_DC NILL DRL'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key = '8604'THEN
    'Brands DC NILL DRL'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key = '8222'THEN
    'Ollerton-DC  NILL DRL'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key not in ('5885','8604','8222')THEN
    'STORE NILL DRL'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_121' THEN
    'BRADFORD ASN NILL PICK'
    WHEN ORS.MODIFYPROGID=' ' THEN
    'CANCELLED AT STORE'
    WHEN ORS.MODIFYPROGID='ISCCSSYS001' THEN
    'CONTACTCENTER'
    WHEN ORS.MODIFYPROGID='MS_STCKIN_TRNSIT_REPLAN' THEN
    'STOCK IN TRANSIT'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_01' THEN
    'NEGATIVE DNR'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_105' THEN
    'NEGATIVE OFR'
    WHEN ORS.MODIFYPROGID='RestServlet' THEN
    'MY ACCOUNT'
    WHEN ORS.MODIFYPROGID='MS_STCKIN_TRNSIT_RETRY' THEN
    'STOCK IN TRANSIT'
    ELSE 'OTHER' END) AS REASON
FROM STRADMIN1.SPKV_yfs_order_header OH, STRADMIN1.yfs_order_release_status ORS , STRADMIN1.SPKV_yfs_order_line OL
WHERE OH.ORDER_HEADER_KEY=OL.ORDER_HEADER_KEY
        AND ol.order_line_key = ORS.order_line_key
        AND ORS.order_header_key=OH.order_header_key
        AND ORS.STATUS='9000'
        AND oh.order_type in ('B2C','B2C_IE')
        AND OH.DOCUMENT_TYPE NOT IN('0003','0005','0006')
        AND ORS.STATUS_QUANTITY IN ('0','1')
        AND ors.ORDER_RELEASE_STATUS_KEY > TO_CHAR( SYSDATE-1 , 'YYYYMMDD' )
        AND ors.ORDER_RELEASE_STATUS_KEY < TO_CHAR( SYSDATE, 'YYYYMMDD' ) 
        GROUP BY to_char(ors.status_date,'yyyy-mm-dd') ,(CASE
    WHEN ORS.MODIFYPROGID in ('Console','SterlingHttpTester','MS_INT_SERVER_113') THEN
    'OPS BAU'
    WHEN ORS.MODIFYPROGID='ORDER_MONITOR_EX' THEN
    'STORE PAYMENT NOT RECEIVED'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_101' THEN
    'STOCK NOT AVAILABLE'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_102' THEN
    'FRAUD NEGATIVE RESPONSE'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_109' AND OL.SHIPNODE_KEY in (SELECT DISTINCT ORGANIZATION_CODE FROM STRADMIN1.YFS_ORGANIZATION WHERE EXTN_PARTICIPATING_BOSS_STORE ='Y'AND ORGANIZATION_CODE NOT IN ('3052','3007')) THEN
    'STORE ORDER PICK EXPIRY'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_109' AND OL.SHIPNODE_KEY not in (SELECT DISTINCT ORGANIZATION_CODE FROM STRADMIN1.YFS_ORGANIZATION WHERE EXTN_PARTICIPATING_BOSS_STORE ='Y'AND ORGANIZATION_CODE NOT IN ('3052','3007')) THEN
    'DC DRL NOT TRIGERED'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key = '5885'THEN
    'Stoke_DC NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key = '8604'THEN
    'Brands DC NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key = '8222'THEN
    'Ollerton-DC  NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120','MS_INT_SERVER_16') and ol.shipnode_key = '4624' THEN
    'CD NILL PICK ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_120') and ol.shipnode_key not in ('5885','8604','8222','4624')THEN
    'STORE NILL ASN'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key = '5885'THEN
    'Stoke_DC NILL DRL'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key = '8604'THEN
    'Brands DC NILL DRL'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key = '8222'THEN
    'Ollerton-DC  NILL DRL'
    WHEN ORS.MODIFYPROGID in ('MS_INT_SERVER_122') and ol.shipnode_key not in ('5885','8604','8222')THEN
    'STORE NILL DRL'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_121' THEN
    'BRADFORD ASN NILL PICK'
    WHEN ORS.MODIFYPROGID=' ' THEN
    'CANCELLED AT STORE'
    WHEN ORS.MODIFYPROGID='ISCCSSYS001' THEN
    'CONTACTCENTER'
    WHEN ORS.MODIFYPROGID='MS_STCKIN_TRNSIT_REPLAN' THEN
    'STOCK IN TRANSIT'
   WHEN ORS.MODIFYPROGID='MS_INT_SERVER_01' THEN
    'NEGATIVE DNR'
    WHEN ORS.MODIFYPROGID='MS_INT_SERVER_105' THEN
    'NEGATIVE OFR'
    WHEN ORS.MODIFYPROGID='RestServlet' THEN
    'MY ACCOUNT'
    WHEN ORS.MODIFYPROGID='MS_STCKIN_TRNSIT_RETRY' THEN
    'STOCK IN TRANSIT'
    ELSE 'OTHER' END)